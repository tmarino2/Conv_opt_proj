% W = randn(30,10);
% Th = (randn(10,1));
% W = W.*(W>0);
% Th = Th.*(Th>0);
% Th = diag(Th);
% pad = zeros(10,990);
% Th_p = [Th, pad];
% H = randn(1000,1000);
% H = H.*(H>0);
% X = W*Th_p*H;
% W0 = randn(30,10);
% W0 = W0.*(W0>0);
% Th0 = randn(10,1);
% Th0 = diag(Th0);
% Th0 = [Th0, pad];
% H0 = randn(1000,1000);
% H0 = H0.*(H0>0);
% % [ Obj, Ws, Ths, Hs, ObjW, ObjTh ] = alt_min( X, W0, Th0, H0, 0.01, 0.5, 0.2 );
% W1 = W + 0.001*W0;
% Th1 = Th_p + 0.001*Th0;
% H1 = H + 0.001*H0;
% [ Obj, Ws, Ths, Hs, ObjW, ObjTh ] = alt_min( X, W1, Th1, H1, 0.01, 0.5, 0.2 );
W = randn(30);
Th = (randn(30,1));
W = W.*(W>0);
Th = Th.*(Th>0);
Th_p = diag(Th);
H = randn(30,1000);
H = H.*(H>0);
X = W*Th_p*H;
W0 = randn(30,30);
W0 = W0.*(W0>0);
Th0 = randn(30,1);
Th0 = diag(Th0);
Th0 = Th0.*(Th0>0);
H0 = randn(30,1000);
H0 = H0.*(H0>0);
[ Obj, Ws, Ths, Hs, ObjW, ObjTh ] = alt_min( X, W0, Th0, H0, 0.1, 1, 0.2 );
% W1 = W + 0.1*W0;
% Th1 = Th_p + 0.1*Th0;
% H1 = H + 0.1*H0;
% [ Obj, Ws, Ths, Hs, ObjW, ObjTh ] = alt_min( X, W1, Th1, H1, 0.01, 0.5, 0.2 );